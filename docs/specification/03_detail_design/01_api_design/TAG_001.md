# TAG_001 タグ一覧取得API
- Method: GET
- Path: /api/tags
- 認証: 要（セッション必須）

## Input
- sessionUserId（UUID, 必須, セッションから取得, 例: "5b8e7e4a-4f21-4d0e-b72f-8d5a2d5c9f3b"）
- target（文字列, 任意, key/value/any のいずれか, query 指定時は必須, 例: "key"）
- query（文字列, 任意, trim後1文字以上, target とセット指定, 例: "Status"）
- key（文字列, 任意, trim後1文字以上, query/target 未指定時のみ使用可, 例: "Status"）
- value（文字列, 任意, trim後1文字以上, query/target 未指定時のみ使用可, 例: "Open"）

## Validation Rule
- Rule V001: target 形式チェック
  - 対象: target
  - 条件: target が "key"/"value"/"any" 以外
  - 判定: NG
  - エラーコード: E-400-VALIDATION
  - メッセージ: "入力値が不正です。"

- Rule V002: query/target 組み合わせチェック
  - 対象: query, target, key, value
  - 条件: query が trim 後に空文字でない かつ target が null
  - 判定: NG
  - エラーコード: E-400-VALIDATION
  - メッセージ: "入力値が不正です。"

- Rule V003: query 指定時の排他チェック
  - 対象: query, key, value
  - 条件: query 指定時に key または value が指定されている
  - 判定: NG
  - エラーコード: E-400-VALIDATION
  - メッセージ: "入力値が不正です。"

- Rule V004: key/value 排他チェック
  - 対象: key, value
  - 条件: key と value を同時指定
  - 判定: NG
  - エラーコード: E-400-VALIDATION
  - メッセージ: "入力値が不正です。"

### チェック順序
1. V001 → NGなら終了
2. V002 → NGなら終了
3. V003 → NGなら終了
4. V004 → NGなら終了
5. 全てOKなら次の処理へ

## Process
- Step 1: セッション認証
  - SessionUserInterceptor でセッション確認
  - NG: E-401-UNAUTHORIZED を返して終了

- Step 2: 入力バリデーション
  - Validation Rule を順に適用
  - NG: E-400-VALIDATION を返して終了

- Step 3: 検索条件の正規化
  - query/key/value を trim
  - query が指定された場合は target に応じて検索条件を割り当てる
    - target=key: tag_key LIKE "%query%"
    - target=value: tag_value LIKE "%query%"
    - target=any: tag_key/tag_value のいずれかに LIKE
  - query 未指定時は key または value のみを検索条件として使用

- Step 4: タグ一覧取得
  - user_id で絞り込み
  - ORDER BY tag_key ASC, tag_value ASC, id ASC

- Step 5: レスポンス生成
  - TagDtoResponse の配列を返却

## Output
### パターン1: 成功
- 型: JSON（配列）
- HTTP: 200
- 例:
  [
    { "id": 1, "tagKey": "Status", "tagValue": "Open" },
    { "id": 2, "tagKey": "Status", "tagValue": "Closed" }
  ]

### パターン2: Validation Error（例: V004）
- 型: JSON
- HTTP: 400
- 例:
  {
    "code": "E-400-VALIDATION",
    "message": "入力値が不正です。",
    "details": [
      { "field": "__global__", "message": "入力値が不正です。" }
    ],
    "operation": "fetch",
    "tagId": null
  }

### パターン3: 認証エラー
- 型: JSON
- HTTP: 401
- 例:
  {
    "code": "E-401-UNAUTHORIZED",
    "message": "セッションユーザーが見つかりません。",
    "details": null,
    "operation": "fetch",
    "tagId": null
  }

### パターン4: システムエラー
- 型: JSON
- HTTP: 500
- 例:
  {
    "code": "E-500-DB",
    "message": "システムエラーが発生しました。",
    "details": null,
    "operation": "fetch",
    "tagId": null
  }

## Error 定義
- E-400-VALIDATION
  - 発生条件: 検索パラメータの組み合わせ不正、または target 不正
  - Input例: target = "key", query = "a", value = "b"
  - 検出Step: Step 2
  - Output例: Output パターン2

- E-401-UNAUTHORIZED
  - 発生条件: セッション未確立または期限切れ
  - 検出Step: Step 1
  - Output例: Output パターン3

- E-500-DB
  - 発生条件: DBアクセス例外
  - 検出Step: Step 4
  - Output例: Output パターン4

- E-500-UNEXPECTED
  - 発生条件: 予期しない例外
  - 検出Step: 全Step
  - Output例:
    {
      "code": "E-500-UNEXPECTED",
      "message": "予期しないエラーが発生しました。",
      "details": null,
      "operation": "fetch",
      "tagId": null
    }
