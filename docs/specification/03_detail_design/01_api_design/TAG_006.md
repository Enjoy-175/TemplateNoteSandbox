# TAG_006 タグ一括削除API
- Method: POST
- Path: /api/tags:batchDelete
- 認証: 要（セッション必須）
- 備考: 冪等（存在しないIDは無視）

## Input
- sessionUserId（UUID, 必須, セッションから取得, 例: "5b8e7e4a-4f21-4d0e-b72f-8d5a2d5c9f3b"）
- ids（配列[整数], 必須, 1〜100件, 各要素は正の整数, 例: [10, 11, 12]）

## Validation Rule
- Rule V001: ids 必須チェック
  - 対象: ids
  - 条件: null または 空配列
  - 判定: NG
  - エラーコード: E-400-VALIDATION
  - メッセージ: "削除対象のIDを1件以上指定してください。"

- Rule V002: ids 件数チェック
  - 対象: ids
  - 条件: 件数 > 100
  - 判定: NG
  - エラーコード: E-400-VALIDATION
  - メッセージ: "削除対象のIDは100件以内で指定してください。"

- Rule V003: ids 要素必須チェック
  - 対象: ids[*]
  - 条件: null を含む
  - 判定: NG
  - エラーコード: E-400-VALIDATION
  - メッセージ: "削除対象IDは必須です。"

- Rule V004: ids 正数チェック
  - 対象: ids[*]
  - 条件: 要素 <= 0
  - 判定: NG
  - エラーコード: E-400-VALIDATION
  - メッセージ: "タグIDは正の整数で指定してください。"

- Rule V005: 正規化チェック
  - 対象: ids
  - 条件: 重複・null除外後の ids が空
  - 判定: NG
  - エラーコード: E-400-VALIDATION
  - メッセージ: "入力値が不正です。"

### チェック順序
1. V001 → NGなら終了
2. V002 → NGなら終了
3. V003 → NGなら終了
4. V004 → NGなら終了
5. V005 → NGなら終了
6. 全てOKなら次の処理へ

## Process
- Step 1: セッション認証
  - SessionUserInterceptor でセッション確認
  - NG: E-401-UNAUTHORIZED を返して終了

- Step 2: 入力バリデーション
  - Validation Rule を順に適用
  - NG: E-400-VALIDATION を返して終了

- Step 3: ID 正規化
  - ids から null を除外し重複排除
  - 結果が空なら E-400-VALIDATION

- Step 4: 所有者チェック
  - ids に含まれるタグを取得（存在しないIDは無視）
  - 他ユーザー所有の id が存在する場合は E-403-TAG-FORBIDDEN
  - details に失敗 id 一覧を付与

- Step 5: 一括削除
  - tags を user_id + ids で削除（存在しないIDは影響なし）
  - トランザクション開始
  - 失敗: ロールバックし E-500-DB

- Step 6: レスポンス生成
  - No Content を返却

## Output
### パターン1: 成功
- 型: なし
- HTTP: 204

### パターン2: Validation Error（例: V001）
- 型: JSON
- HTTP: 400
- 例:
  {
    "code": "E-400-VALIDATION",
    "message": "削除対象のIDを1件以上指定してください。",
    "details": [
      { "field": "ids", "message": "削除対象のIDを1件以上指定してください。" }
    ],
    "operation": "delete",
    "tagId": null
  }

### パターン3: 業務エラー（権限なし）
- 型: JSON
- HTTP: 403
- 例:
  {
    "code": "E-403-TAG-FORBIDDEN",
    "message": "他のユーザーのタグは操作できません。",
    "details": {
      "results": [
        { "id": 15, "status": "failed", "reasonCode": "E-403-TAG-FORBIDDEN", "message": "他のユーザーのタグは操作できません。" }
      ]
    },
    "operation": "delete",
    "tagId": null
  }

### パターン4: 認証エラー
- 型: JSON
- HTTP: 401
- 例:
  {
    "code": "E-401-UNAUTHORIZED",
    "message": "セッションユーザーが見つかりません。",
    "details": null,
    "operation": "delete",
    "tagId": null
  }

### パターン5: システムエラー
- 型: JSON
- HTTP: 500
- 例:
  {
    "code": "E-500-DB",
    "message": "システムエラーが発生しました。",
    "details": null,
    "operation": "delete",
    "tagId": null
  }

## Error 定義
- E-400-VALIDATION
  - 発生条件: ids の必須/件数/要素バリデーションNG、または正規化後に空
  - Input例: ids = []
  - 検出Step: Step 2 / Step 3
  - Output例: Output パターン2

- E-403-TAG-FORBIDDEN
  - 発生条件: ids に他ユーザーのタグが含まれる
  - Input例: ids = [15]（他ユーザー所有）
  - 検出Step: Step 4
  - Output例: Output パターン3

- E-401-UNAUTHORIZED
  - 発生条件: セッション未確立または期限切れ
  - 検出Step: Step 1
  - Output例: Output パターン4

- E-500-DB
  - 発生条件: DBアクセス例外
  - 検出Step: Step 5
  - Output例: Output パターン5

- E-500-UNEXPECTED
  - 発生条件: 予期しない例外
  - 検出Step: 全Step
  - Output例:
    {
      "code": "E-500-UNEXPECTED",
      "message": "予期しないエラーが発生しました。",
      "details": null,
      "operation": "delete",
      "tagId": null
    }
